---
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";
import Search from "../components/Search.astro";
import PostCard from "../components/PostCard.astro";

const posts = await getCollection("posts");
const publishedPosts = posts
  .filter((entry) => !entry.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base
  title="Mete Morris Blog | Site Reliability & Systems Writing"
  description="Browse Mete Morris' Site Reliability and AI/ML engineering essays, systems thinking frameworks, and practical career lessons for modern builders."
>
  <div class="space-y-10 mx-auto max-w-[65ch]">
    <section class="space-y-5 fade-in mt-6">
      <div class="flex items-center justify-between">
        <p class="eyebrow">Latest entries</p>
      </div>
      <Search />
      <div class="space-y-5">
        {
          publishedPosts.length === 0 && (
            <p class="muted text-sm border-t border-[var(--page-border)] pt-4">
              No posts yet â€” stay tuned.
            </p>
          )
        }

        {
          publishedPosts.map((entry) => (
            <PostCard
              slug={entry.slug}
              title={entry.data.title}
              description={entry.data.description}
              date={entry.data.date}
              tags={entry.data.tags}
              showTags={true}
            />
          ))
        }
      </div>
    </section>
  </div>
</Base>
