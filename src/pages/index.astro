---
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";
import { experience, education } from "../data/resume";
import Section from "../components/Section.astro";
import SectionHeader from "../components/SectionHeader.astro";

const posts = await getCollection("posts");
const latestPost = posts
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .at(0);

const personStructuredData = {
  "@context": "https://schema.org",
  "@type": "Person",
  name: "Mete Morris",
  url: "https://www.metemorris.com/",
  jobTitle: "Site Reliability and AI/ML Engineer",
  worksFor: {
    "@type": "Organization",
    name: "Google",
  },
  sameAs: [
    "https://twitter.com/metemorris",
    "https://www.linkedin.com/in/metemorris",
  ],
  description:
    "Mete Morris is a Google SRE and AI/ML engineer sharing systems thinking essays, career notes, and engineering projects.",
};
---

<Base
  title="Mete Morris | Site Reliability & AI/ML Engineer"
  description="Mete Morris' official site covering Site Reliability, AI/ML engineering lessons, systems thinking essays, and personal projects in software and political science."
  structuredData={[personStructuredData]}
>
  <section class="grid gap-8 md:grid-cols-[1.2fr,1fr] md:items-start fade-in">
    <div class="flex justify-center md:order-2 md:justify-end">
      <div
        class="h-40 w-40 rounded-full border border-[var(--page-border)] overflow-hidden transition-[border-color,filter] duration-300"
      >
        <img
          src="/headshot.jpg"
          alt="Mete Morris headshot"
          class="h-full w-full object-cover transition-[filter] duration-300"
          style="object-position: 80% 55%; transform: scale(1.5); transform-origin: 60% 60%; filter: var(--avatar-filter);"
        />
      </div>
    </div>

    <div class="space-y-4 max-w-[65ch] md:order-1">
      <div class="space-y-1">
        <h1 class="text-4xl font-semibold leading-tight">Mete Morris</h1>
      </div>
      <p class="muted text-sm">
        I build and debug AI and ML systems at Google and recharge by playing
        guitar, reading, and keeping my body moving.
      </p>
    </div>
  </section>

  <Section>
    <SectionHeader title="Latest post" />
    {
      latestPost ? (
        <article class="border-t border-[var(--page-border)] pt-4">
          <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <a
                class="text-lg font-semibold hover:underline"
                href={`/posts/${latestPost.slug}/`}
              >
                {latestPost.data.title}
              </a>
              <p class="muted text-sm">{latestPost.data.description}</p>
            </div>
            <time
              class="text-xs uppercase tracking-[0.3em] text-[var(--page-muted)]"
              datetime={latestPost.data.date.toISOString()}
            >
              {latestPost.data.date.toLocaleDateString(undefined, {
                month: "short",
                day: "numeric",
                year: "numeric",
              })}
            </time>
          </div>
        </article>
      ) : (
        <p class="muted text-sm border-t border-[var(--page-border)] pt-4">
          No posts yet.
        </p>
      )
    }
  </Section>

  <Section>
    <SectionHeader title="Experience" />
    <div class="space-y-6">
      {
        experience.map((item) => (
          <article class="flex flex-col gap-3 border-t border-[var(--page-border)] pt-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <p class="text-xs uppercase tracking-[0.3em] text-[var(--page-muted)]">
                {item.period}
              </p>
              <h2 class="text-lg font-semibold">{item.titleLine}</h2>
              <p class="muted text-sm">{item.orgLine}</p>
            </div>
            <p class="muted text-sm sm:max-w-sm">{item.summary}</p>
          </article>
        ))
      }
    </div>
  </Section>

  <Section withDivider>
    <SectionHeader title="Education" />
    <div class="space-y-5">
      {
        education.map((item) => (
          <article class="flex flex-col gap-2 border-t border-[var(--page-border)] pt-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
              <h3 class="text-lg font-semibold">{item.school}</h3>
              <p class="muted text-sm">{item.details}</p>
            </div>
            <p class="text-xs uppercase tracking-[0.3em] text-[var(--page-muted)]">
              {item.period}
            </p>
          </article>
        ))
      }
    </div>
  </Section>
</Base>
